# MySQL 엔진 아키텍처
      
MySQL 서버는 머리 역할을 담당하는 MySQL 엔진과         
손과 발의 역할을 담당하는 스토리지 엔진으로 구분할 수 있다.      
  
스토리지 엔진은 핸들러 API를 만족하면 누구든지 스토리지 엔진을 구현해서 MySQL 서버에 추가해서 사용할 수 있다.        
이번 챕터에서는 MySQL 엔진과 InnoDB 스토리지 엔진, 그리고 MyISAM 스토리지 엔진을 구분해서 살펴보겠습니다.    
    
# MySQL 엔진 아키텍처      
## MySQL의 전체 구조

![images_jsj3282_post_aa130a72-12de-4d7a-b32e-52be236ab026_image](https://user-images.githubusercontent.com/50267433/193463535-1ef89ac4-abda-43f6-b832-eebeabbe4b15.png)

MySQL 은 일반 상용 RDBMS 와 같이 대부분의 프로그래밍 언어로부터 접근 방법을 모두 지원한다.       
MySQL 서버는 크게 MySQL 엔진과 스토리지 엔진으로 구분할 수 있다.         
이 책에서는 MySQL의 쿼리파서 옵티마이저 등과 같은 기능을 스토리지 엔진과 구분하고자 'MySQL 엔진'과 '스토리지 엔진'으로 구분했다.      
그리고 이 둘을 모두 합쳐서 그냥 MySQL 또는 MySQL 서버라고 표현하겠다.        

### MySQL 엔진  
MySQL 엔진은 요청된 SQL문을 분석하거나 최적화하는 등 DBMS 의 두뇌 역할을 한다.   
MySQL 엔진은 클라이언트로부터의 접속 및 쿼리 요청을 처리하는 커넥션 핸들러와    
SQL 파서 및 전처리기, 쿼리의 최적화된 실행을 위한 옵티마이저가 중심을 이룬다.    

### 스토리지 엔진  
스토리지 엔진은 실제 데이터를 디스크 스토리지에 저장하거나    
디스크 스토리지로부터 데이터를 읽어오는 부분을 담당한다.     
  
MySQL에서 MySQL 엔진은 하나이지만, 스토리지 엔진은 여러개를 동시에 사용할 수 있다.     
테이블을 정의할 때 사용하고자 하는 스토리지 엔진을 명시적으로 지정할 수 있다.  
 
### 핸들러 API    
MySQL 엔진의 쿼리 실행기에서      
데이터를 쓰거나 읽어야할 때는 각 스토리지 엔진에 쓰기 또는 읽기를 요청하는데,     
이러한 요청을 핸들러 요청이라하고 여기서 사용되는 API를 핸들러 API라고 부른다.      

InnoDB 스토리지 엔진 또한 이 핸들러 API를 이용해 MySQL 엔진과 데이터를 주고 받는다.  

## MySQL 스레딩 구조   

MySQL 서버는 프로세스 기반이 아니라 스레드 기반으로 작동하며       
크게 `포그라운드 스레드`와, `백그라운드 스레드`로 구분할 수 있다.        

### 포그라운드 스레드(클라이언트 스레드)
포그라운드 스레드는 최소한 MySQL 서버에 접속한 클라이언트의 수만큼 존재하며       
주로 각 클라이언트 사용자가 요청하는 쿼리 문장을 처리한다.      
  
클라이언트 사용자가 작업을 마치고 커넥션을 종료하면 해당 커넥션을 담당하던 스레드는 다시 스레드 캐시로 돌아온다.     
이때 이미 스레드 캐시에 일정 개수 이상의 대기 중인 스레드가 있으면 스레드 캐시에 넣지 않고 스레드를 종료시키기도 한다.   
반대로 스레드 캐시 이상의 스레드가 필요할 때 임의적으로 생성해서 사용하는 것을 알 수 있다.     




## 메모리 할당 및 사용 구조   
### 글로벌 메모리 영역  
### 로컬 메모리 영역 
